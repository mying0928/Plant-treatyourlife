---
import '../styles/global.css';
const { title } = Astro.props;
---
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{title}</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
    <script is:inline src="https://unpkg.com/lucide@latest"></script>
    <style is:global>
        @font-face {
            font-family: 'ChenYuluoyan';
            src: url('/Plant-treatyourlife/fonts/ChenYuluoyan-2.0-Thin.ttf') format('truetype');
        }
    </style>
</head>
<body class="text-gray-200">
    <!-- <canvas id="particle-canvas"></canvas> -->
    <!-- <div id="youtube-player-container"></div> -->
    <slot />
    <footer class="text-center mt-16 pb-8">
        <p class="text-gray-500 dark:text-gray-400">&copy; <span id="year"></span> 我的植物養護紀錄. All Rights Reserved.</p>
    </footer>
    <script is:inline>
        // 所有客戶端互動腳本
        function initializeSearch() {
            const searchInput = document.getElementById('searchInput');
            const plantGrid = document.getElementById('plantGrid');
            const noResultsMessage = document.getElementById('noResultsMessage');
            const searchTermDisplay = document.getElementById('searchTermDisplay');
            if (!searchInput || !plantGrid || !noResultsMessage) return;
            searchInput.addEventListener('input', (event) => {
                const searchTerm = event.target.value.toLowerCase().trim();
                let visibleCount = 0;
                const allCards = plantGrid.querySelectorAll('.plant-card');
                allCards.forEach(card => {
                    const plantName = card.dataset.plantName;
                    const isVisible = searchTerm === "" || plantName.includes(searchTerm);
                    card.classList.toggle('hidden', !isVisible);
                    if (isVisible) visibleCount++;
                });
                noResultsMessage.classList.toggle('hidden', !(visibleCount === 0 && searchTerm.length > 0));
                if (visibleCount === 0) {
                    searchTermDisplay.textContent = event.target.value;
                }
            });
        }
        function initializeScrollToTop() {
            const scrollToTopBtn = document.getElementById('scrollToTopBtn');
            if (scrollToTopBtn) {
                window.addEventListener('scroll', () => {
                    const isVisible = window.scrollY > 300;
                    scrollToTopBtn.classList.toggle('opacity-0', !isVisible);
                    scrollToTopBtn.classList.toggle('invisible', !isVisible);
                    scrollToTopBtn.classList.toggle('translate-y-2', !isVisible);
                });
                scrollToTopBtn.addEventListener('click', () => {
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                });
            }
        }
        function initializeHoverEffects() {
            const grid = document.getElementById('plantGrid');
            if (!grid) return;
            function applyCardTransform(e, card) {
                const image = card.querySelector('.card-image');
                const rect = card.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;
                const xPercent = x / rect.width;
                const yPercent = y / rect.height;
                const rotateX = (yPercent - 0.5) * 2 * -8;
                const rotateY = (xPercent - 0.5) * 2 * 8;
                card.style.transition = 'none';
                card.style.transform = `perspective(1000px) rotateX(${rotateX}deg) rotateY(${rotateY}deg) scale(1.05)`;
                if (image) {
                    image.style.transition = 'none';
                    const moveX = (xPercent - 0.5) * 20;
                    const moveY = (yPercent - 0.5) * 20;
                    image.style.transform = `scale(1.2) translateX(${moveX}px) translateY(${moveY}px)`;
                }
            }
            function resetCardTransform(card) {
                const image = card.querySelector('.card-image');
                card.style.transition = 'transform 0.4s ease-out';
                card.style.transform = 'perspective(1000px) rotateX(0) rotateY(0) scale(1)';
                if (image) {
                    image.style.transition = 'transform 0.4s ease-out';
                    image.style.transform = 'scale(1) translateX(0) translateY(0)';
                }
            }
            grid.addEventListener('mousemove', (e) => {
                const card = e.target.closest('.plant-card');
                if (card) { applyCardTransform(e, card); }
            });
            grid.addEventListener('mouseleave', () => {
                const allCards = grid.querySelectorAll('.plant-card');
                allCards.forEach(resetCardTransform);
            });
            grid.addEventListener('mouseover', (e) => {
                const currentCard = e.target.closest('.plant-card');
                const allCards = grid.querySelectorAll('.plant-card');
                allCards.forEach(card => {
                    if (card !== currentCard) { resetCardTransform(card); }
                });
            });
        }
        document.addEventListener('DOMContentLoaded', function () {
            initializeSearch();
            // initializeParticleEffect();
            // initializeMusicPlayer();
            initializeScrollToTop();
            initializeHoverEffects();
            document.getElementById('year').textContent = new Date().getFullYear();
            lucide.createIcons();
        });
    </script>
</body>
</html>

